{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _toConsumableArray from \"/opt/js/storage_sys/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _regeneratorRuntime from \"/opt/js/storage_sys/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/opt/js/storage_sys/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _defineProperty from \"/opt/js/storage_sys/node_modules/@babel/runtime/helpers/esm/defineProperty\";\n\nvar _jsxFileName = \"/opt/js/storage_sys/contexts/models/data.js\",\n    _s = $RefreshSig$();\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useRouter } from 'next/router';\nvar ContextData = /*#__PURE__*/React.createContext();\n\nfunction ProviderData(props) {\n  _s();\n\n  var router = useRouter();\n  var slug = router.query.slug;\n\n  var _useState = useState([]),\n      listRecords = _useState[0],\n      setListRecords = _useState[1];\n\n  var _useState2 = useState(false),\n      checkAll = _useState2[0],\n      setCheckAll = _useState2[1];\n\n  var _useState3 = useState(null),\n      dataShare = _useState3[0],\n      setDataShare = _useState3[1];\n\n  var _useState4 = useState(false),\n      shared = _useState4[0],\n      setShared = _useState4[1];\n\n  var elCheckAll = useCallback(function (el) {\n    if (el) {\n      if (checkAll === null) {\n        el.indeterminate = true;\n      } else {\n        el.indeterminate = false;\n      }\n    }\n  }, [checkAll]);\n\n  var toggleCheck = function toggleCheck() {\n    var ids = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    ids = ids.length ? ids : listRecords.filter(function (item) {\n      return checkAll === null ? Boolean(item.selected) : !checkAll != Boolean(item.selected);\n    }).map(function (item) {\n      return item.id;\n    });\n    var newListRecords = listRecords.map(function (item) {\n      return ids.includes(item.id) ? _objectSpread(_objectSpread({}, item), {}, {\n        selected: !item.selected\n      }) : item;\n    });\n    var selectedRecords = newListRecords.filter(function (item) {\n      return item.selected;\n    });\n    setCheckAll(selectedRecords.length < newListRecords.length ? selectedRecords.length ? null : false : !checkAll);\n    setListRecords(newListRecords);\n  };\n\n  var getData = /*#__PURE__*/function () {\n    var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n      var _yield$fetch$then, entries;\n\n      return _regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              _context.next = 2;\n              return fetch(\"/api/get-list-folder/\".concat((slug || []).join('/'))).then(function (res) {\n                return res.json();\n              });\n\n            case 2:\n              _yield$fetch$then = _context.sent;\n              entries = _yield$fetch$then.entries;\n\n              if (entries) {\n                setListRecords(entries);\n                setCheckAll(false);\n              }\n\n            case 5:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee);\n    }));\n\n    return function getData() {\n      return _ref.apply(this, arguments);\n    };\n  }();\n\n  var getDataShared = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      var _yield$fetch$then2, error, folders, files;\n\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              _context2.next = 2;\n              return fetch('/api/get-list-shared').then(function (res) {\n                return res.json();\n              });\n\n            case 2:\n              _yield$fetch$then2 = _context2.sent;\n              error = _yield$fetch$then2.error;\n              folders = _yield$fetch$then2.folders;\n              files = _yield$fetch$then2.files;\n\n              if (!error) {\n                folders.entries = folders.entries.map(function (item) {\n                  return _objectSpread(_objectSpread({}, item), {}, {\n                    \".tag\": \"folder\"\n                  });\n                });\n                files.entries = files.entries.map(function (item) {\n                  return _objectSpread(_objectSpread({}, item), {}, {\n                    \".tag\": \"file\"\n                  });\n                });\n                setListRecords([].concat(_toConsumableArray(folders.entries), _toConsumableArray(files.entries)));\n              }\n\n            case 7:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function getDataShared() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(ContextData.Provider, {\n    value: {\n      listRecords: listRecords,\n      setListRecords: setListRecords,\n      shared: shared,\n      setShared: setShared,\n      checkAll: checkAll,\n      setCheckAll: setCheckAll,\n      dataShare: dataShare,\n      setDataShare: setDataShare,\n      elCheckAll: elCheckAll,\n      toggleCheck: toggleCheck,\n      getData: getData,\n      getDataShared: getDataShared\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 7\n  }, this);\n}\n\n_s(ProviderData, \"StLdcE85CsIsn8AbETACk/dbSBY=\", false, function () {\n  return [useRouter];\n});\n\n_c = ProviderData;\nexport default ProviderData;\nexport { ContextData };\n\nvar _c;\n\n$RefreshReg$(_c, \"ProviderData\");","map":{"version":3,"sources":["/opt/js/storage_sys/contexts/models/data.js"],"names":["React","useState","useEffect","useCallback","useRouter","ContextData","createContext","ProviderData","props","router","slug","query","listRecords","setListRecords","checkAll","setCheckAll","dataShare","setDataShare","shared","setShared","elCheckAll","el","indeterminate","toggleCheck","ids","length","filter","item","Boolean","selected","map","id","newListRecords","includes","selectedRecords","getData","fetch","join","then","res","json","entries","getDataShared","error","folders","files","children"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useRouter } from 'next/router'\n\nconst ContextData = React.createContext()\n\nfunction ProviderData(props){\n   const router = useRouter()\n   const { slug } = router.query\n   const [listRecords, setListRecords] = useState([])\n   const [checkAll, setCheckAll] = useState(false)\n   const [dataShare, setDataShare] = useState(null)\n   const [shared, setShared] = useState(false)\n\n   const elCheckAll = useCallback(el => {\n      if(el){\n         if(checkAll === null){\n            el.indeterminate = true\n         }else{\n            el.indeterminate = false\n         }\n      }\n   }, [checkAll]);\n\n   const toggleCheck = (ids=[])=>{\n      ids = ids.length ? ids :\n         listRecords\n         .filter(item => checkAll === null ? Boolean(item.selected) : !checkAll != Boolean(item.selected))\n         .map(item => item.id)\n      let newListRecords = listRecords.map(item => ids.includes(item.id) ? {...item,selected:!item.selected} : item)\n      let selectedRecords = newListRecords.filter(item => item.selected)\n      setCheckAll(selectedRecords.length < newListRecords.length ? selectedRecords.length ? null : false : !checkAll)\n      setListRecords(newListRecords)\n   }\n\n   const getData = async()=>{\n      let { entries } = await fetch(`/api/get-list-folder/${(slug || []).join('/')}`)\n         .then(res => res.json())\n      if(entries){\n         setListRecords(entries)\n         setCheckAll(false)\n      }\n   }\n\n   const getDataShared = async()=>{\n      let { error, folders, files } = await fetch('/api/get-list-shared')\n         .then(res => res.json())\n      if(!error){\n         folders.entries = folders.entries.map(item => ({...item, \".tag\": \"folder\"}))\n         files.entries = files.entries.map(item => ({...item, \".tag\": \"file\"}))\n         setListRecords([...folders.entries, ...files.entries])\n      }\n   }\n\n   return(\n      <ContextData.Provider value={{\n         listRecords,\n         setListRecords,\n         shared,\n         setShared,\n         checkAll,\n         setCheckAll,\n         dataShare,\n         setDataShare,\n         elCheckAll,\n         toggleCheck,\n         getData,\n         getDataShared,\n      }}>\n         {props.children}\n      </ContextData.Provider>\n   )\n}\nexport default ProviderData\nexport { ContextData }\n"]},"metadata":{},"sourceType":"module"}