{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport _regeneratorRuntime from \"/opt/js/storage_sys/node_modules/@babel/runtime/regenerator\";\nimport _objectWithoutProperties from \"/opt/js/storage_sys/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _asyncToGenerator from \"/opt/js/storage_sys/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\n\nvar _jsxFileName = \"/opt/js/storage_sys/contexts/models/auth.js\",\n    _s = $RefreshSig$();\n\nimport React, { useState, useEffect } from 'react';\nvar ContextAuth = /*#__PURE__*/React.createContext();\n\nfunction ProviderAuth(props) {\n  _s();\n\n  var _useState = useState(),\n      session = _useState[0],\n      setSession = _useState[1];\n\n  var _useState2 = useState(true),\n      loading = _useState2[0],\n      setLoading = _useState2[1];\n\n  useEffect(function () {\n    var handleAuthenticated = /*#__PURE__*/function () {\n      var _ref = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        var _yield$yield$fetch$js, error, rest;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return fetch('/api/check-auth');\n\n              case 2:\n                _context.next = 4;\n                return _context.sent.json();\n\n              case 4:\n                _yield$yield$fetch$js = _context.sent;\n                error = _yield$yield$fetch$js.error;\n                rest = _objectWithoutProperties(_yield$yield$fetch$js, [\"error\"]);\n\n                if (!error) {\n                  setSession(rest);\n                }\n\n                setLoading(false);\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee);\n      }));\n\n      return function handleAuthenticated() {\n        return _ref.apply(this, arguments);\n      };\n    }();\n\n    handleAuthenticated();\n  }, []);\n\n  var createSession = function createSession(user) {\n    setSession(user);\n  };\n\n  var removeSession = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2() {\n      return _regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              fetch('/api/logout');\n              setSession();\n\n            case 2:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2);\n    }));\n\n    return function removeSession() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n\n  return /*#__PURE__*/_jsxDEV(ContextAuth.Provider, {\n    value: {\n      session: session,\n      loading: loading,\n      setSession: setSession,\n      setLoading: setLoading,\n      createSession: createSession,\n      removeSession: removeSession\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 30,\n    columnNumber: 7\n  }, this);\n}\n\n_s(ProviderAuth, \"LtAEXK5hv56ZybRIbC2clJ9vadM=\");\n\n_c = ProviderAuth;\nexport default ProviderAuth;\nexport { ContextAuth };\n\nvar _c;\n\n$RefreshReg$(_c, \"ProviderAuth\");","map":{"version":3,"sources":["/opt/js/storage_sys/contexts/models/auth.js"],"names":["React","useState","useEffect","ContextAuth","createContext","ProviderAuth","props","session","setSession","loading","setLoading","handleAuthenticated","fetch","json","error","rest","createSession","user","removeSession","children"],"mappings":";;;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,QAA2C,OAA3C;AAEA,IAAMC,WAAW,gBAAGH,KAAK,CAACI,aAAN,EAApB;;AAEA,SAASC,YAAT,CAAsBC,KAAtB,EAA4B;AAAA;;AAAA,kBACIL,QAAQ,EADZ;AAAA,MAClBM,OADkB;AAAA,MACVC,UADU;;AAAA,mBAEIP,QAAQ,CAAC,IAAD,CAFZ;AAAA,MAElBQ,OAFkB;AAAA,MAEVC,UAFU;;AAIzBR,EAAAA,SAAS,CAAC,YAAI;AACX,QAAMS,mBAAmB;AAAA,0EAAG;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBACYC,KAAK,CAAC,iBAAD,CADjB;;AAAA;AAAA;AAAA,qCACsCC,IADtC;;AAAA;AAAA;AACnBC,gBAAAA,KADmB,yBACnBA,KADmB;AACTC,gBAAAA,IADS;;AAEzB,oBAAG,CAACD,KAAJ,EAAU;AACPN,kBAAAA,UAAU,CAACO,IAAD,CAAV;AACF;;AACDL,gBAAAA,UAAU,CAAC,KAAD,CAAV;;AALyB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAH;;AAAA,sBAAnBC,mBAAmB;AAAA;AAAA;AAAA,OAAzB;;AAOAA,IAAAA,mBAAmB;AACrB,GATQ,EASP,EATO,CAAT;;AAWA,MAAMK,aAAa,GAAG,SAAhBA,aAAgB,CAACC,IAAD,EAAQ;AAC3BT,IAAAA,UAAU,CAACS,IAAD,CAAV;AACF,GAFD;;AAIA,MAAMC,aAAa;AAAA,yEAAG;AAAA;AAAA;AAAA;AAAA;AACnBN,cAAAA,KAAK,CAAC,aAAD,CAAL;AACAJ,cAAAA,UAAU;;AAFS;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAH;;AAAA,oBAAbU,aAAa;AAAA;AAAA;AAAA,KAAnB;;AAKA,sBACG,QAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE;AAC1BX,MAAAA,OAAO,EAAPA,OAD0B;AAE1BE,MAAAA,OAAO,EAAPA,OAF0B;AAG1BD,MAAAA,UAAU,EAAVA,UAH0B;AAI1BE,MAAAA,UAAU,EAAVA,UAJ0B;AAK1BM,MAAAA,aAAa,EAAbA,aAL0B;AAM1BE,MAAAA,aAAa,EAAbA;AAN0B,KAA7B;AAAA,cAQIZ,KAAK,CAACa;AARV;AAAA;AAAA;AAAA;AAAA,UADH;AAYF;;GApCQd,Y;;KAAAA,Y;AAsCT,eAAeA,YAAf;AACA,SAASF,WAAT","sourcesContent":["import React, { useState, useEffect } from 'react';\n\nconst ContextAuth = React.createContext()\n\nfunction ProviderAuth(props){\n   const [session,setSession] = useState()\n   const [loading,setLoading] = useState(true)\n\n   useEffect(()=>{\n      const handleAuthenticated = async()=>{\n         let { error, ...rest} = await (await fetch('/api/check-auth')).json()\n         if(!error){\n            setSession(rest)\n         }\n         setLoading(false)\n      }\n      handleAuthenticated()\n   },[])\n\n   const createSession = (user)=>{\n      setSession(user)\n   }\n\n   const removeSession = async()=>{\n      fetch('/api/logout')\n      setSession()\n   }\n\n   return(\n      <ContextAuth.Provider value={{\n         session,\n         loading,\n         setSession,\n         setLoading,\n         createSession,\n         removeSession\n      }}>\n         {props.children}\n      </ContextAuth.Provider>\n   )\n}\n\nexport default ProviderAuth\nexport { ContextAuth }\n"]},"metadata":{},"sourceType":"module"}