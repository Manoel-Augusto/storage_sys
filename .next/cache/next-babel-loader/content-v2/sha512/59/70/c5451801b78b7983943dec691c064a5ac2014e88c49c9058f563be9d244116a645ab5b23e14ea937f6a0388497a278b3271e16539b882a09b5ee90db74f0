{"ast":null,"code":"import { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nvar _jsxFileName = \"/opt/js/storage_sys/contexts/models/auth.js\";\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport React, { useState, useEffect, useCallback } from 'react';\nimport { useRouter } from 'next/router';\nconst ContextAuth = /*#__PURE__*/React.createContext();\n\nfunction ProviderAuth(props) {\n  const router = useRouter();\n  const {\n    0: session,\n    1: setSession\n  } = useState();\n  const {\n    0: cookies,\n    1: setCookies\n  } = useState(false);\n  const {\n    0: loading,\n    1: setLoading\n  } = useState(true);\n  const {\n    0: authenticated,\n    1: setAuthenticated\n  } = useState(false);\n  useEffect(() => {\n    const handleAuthenticated = async () => {\n      let _await$await$fetch$js = await (await fetch('/api/check-auth')).json(),\n          {\n        error\n      } = _await$await$fetch$js,\n          rest = _objectWithoutProperties(_await$await$fetch$js, [\"error\"]);\n\n      if (!error) {\n        setSession(rest);\n      }\n\n      setLoading(false);\n    };\n\n    handleAuthenticated();\n  }, []);\n\n  const createSession = user => {\n    localStorage.setItem(\"ss\", JSON.stringify(user));\n    setSession(user);\n    setAuthenticated(true);\n  };\n\n  const removeSession = () => {\n    localStorage.removeItem(\"ss\");\n    setSession(null);\n    setAuthenticated(false);\n  };\n\n  return /*#__PURE__*/_jsxDEV(ContextAuth.Provider, {\n    value: {\n      session,\n      loading,\n      setCookies,\n      setSession,\n      authenticated,\n      createSession,\n      removeSession\n    },\n    children: props.children\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 37,\n    columnNumber: 7\n  }, this);\n}\n\nexport default ProviderAuth;\nexport { ContextAuth };","map":{"version":3,"sources":["/opt/js/storage_sys/contexts/models/auth.js"],"names":["React","useState","useEffect","useCallback","useRouter","ContextAuth","createContext","ProviderAuth","props","router","session","setSession","cookies","setCookies","loading","setLoading","authenticated","setAuthenticated","handleAuthenticated","fetch","json","error","rest","createSession","user","localStorage","setItem","JSON","stringify","removeSession","removeItem","children"],"mappings":";;;;;;;AAAA,OAAOA,KAAP,IAAgBC,QAAhB,EAA0BC,SAA1B,EAAqCC,WAArC,QAAwD,OAAxD;AACA,SAASC,SAAT,QAA0B,aAA1B;AAEA,MAAMC,WAAW,gBAAGL,KAAK,CAACM,aAAN,EAApB;;AAEA,SAASC,YAAT,CAAsBC,KAAtB,EAA4B;AACzB,QAAMC,MAAM,GAAGL,SAAS,EAAxB;AACA,QAAM;AAAA,OAACM,OAAD;AAAA,OAASC;AAAT,MAAuBV,QAAQ,EAArC;AACA,QAAM;AAAA,OAACW,OAAD;AAAA,OAASC;AAAT,MAAuBZ,QAAQ,CAAC,KAAD,CAArC;AACA,QAAM;AAAA,OAACa,OAAD;AAAA,OAASC;AAAT,MAAuBd,QAAQ,CAAC,IAAD,CAArC;AACA,QAAM;AAAA,OAACe,aAAD;AAAA,OAAeC;AAAf,MAAmChB,QAAQ,CAAC,KAAD,CAAjD;AAEAC,EAAAA,SAAS,CAAC,MAAI;AACX,UAAMgB,mBAAmB,GAAG,YAAS;AAClC,kCAAwB,MAAM,CAAC,MAAMC,KAAK,CAAC,iBAAD,CAAZ,EAAiCC,IAAjC,EAA9B;AAAA,UAAI;AAAEC,QAAAA;AAAF,OAAJ;AAAA,UAAgBC,IAAhB;;AACA,UAAG,CAACD,KAAJ,EAAU;AACPV,QAAAA,UAAU,CAACW,IAAD,CAAV;AACF;;AACDP,MAAAA,UAAU,CAAC,KAAD,CAAV;AACF,KAND;;AAOAG,IAAAA,mBAAmB;AACrB,GATQ,EASP,EATO,CAAT;;AAWA,QAAMK,aAAa,GAAIC,IAAD,IAAQ;AAC3BC,IAAAA,YAAY,CAACC,OAAb,CAAqB,IAArB,EAA2BC,IAAI,CAACC,SAAL,CAAeJ,IAAf,CAA3B;AACAb,IAAAA,UAAU,CAACa,IAAD,CAAV;AACAP,IAAAA,gBAAgB,CAAC,IAAD,CAAhB;AACF,GAJD;;AAMA,QAAMY,aAAa,GAAG,MAAI;AACvBJ,IAAAA,YAAY,CAACK,UAAb,CAAwB,IAAxB;AACAnB,IAAAA,UAAU,CAAC,IAAD,CAAV;AACAM,IAAAA,gBAAgB,CAAC,KAAD,CAAhB;AACF,GAJD;;AAMA,sBACG,QAAC,WAAD,CAAa,QAAb;AAAsB,IAAA,KAAK,EAAE;AAC1BP,MAAAA,OAD0B;AAE1BI,MAAAA,OAF0B;AAG1BD,MAAAA,UAH0B;AAI1BF,MAAAA,UAJ0B;AAK1BK,MAAAA,aAL0B;AAM1BO,MAAAA,aAN0B;AAO1BM,MAAAA;AAP0B,KAA7B;AAAA,cASIrB,KAAK,CAACuB;AATV;AAAA;AAAA;AAAA;AAAA,UADH;AAaF;;AAED,eAAexB,YAAf;AACA,SAASF,WAAT","sourcesContent":["import React, { useState, useEffect, useCallback } from 'react';\nimport { useRouter } from 'next/router'\n\nconst ContextAuth = React.createContext()\n\nfunction ProviderAuth(props){\n   const router = useRouter()\n   const [session,setSession] = useState()\n   const [cookies,setCookies] = useState(false)\n   const [loading,setLoading] = useState(true)\n   const [authenticated,setAuthenticated] = useState(false)\n\n   useEffect(()=>{\n      const handleAuthenticated = async()=>{\n         let { error, ...rest} = await (await fetch('/api/check-auth')).json()\n         if(!error){\n            setSession(rest)\n         }\n         setLoading(false)\n      }\n      handleAuthenticated()\n   },[])\n\n   const createSession = (user)=>{\n      localStorage.setItem(\"ss\", JSON.stringify(user))\n      setSession(user)\n      setAuthenticated(true)\n   }\n\n   const removeSession = ()=>{\n      localStorage.removeItem(\"ss\")\n      setSession(null)\n      setAuthenticated(false)\n   }\n\n   return(\n      <ContextAuth.Provider value={{\n         session,\n         loading,\n         setCookies,\n         setSession,\n         authenticated,\n         createSession,\n         removeSession\n      }}>\n         {props.children}\n      </ContextAuth.Provider>\n   )\n}\n\nexport default ProviderAuth\nexport { ContextAuth }\n"]},"metadata":{},"sourceType":"module"}